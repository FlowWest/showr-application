spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
) %>%
select(-lagrange) %>%
gather(site, flow, lagrange:lag_l) %>%
ggplot(aes(date, flow, color=site)) + geom_line()
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
) %>%
select(-lagrange) %>%
gather(site, flow, lagrange:lag_l) %>%
ggplot(aes(date, flow, color=site)) + geom_line()
d %>%
spread(site, flow)
d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
) %>%
select(-lagrange)
d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
) %>%
select(-lagrange) %>%
gather(site, flow, mod:lag_l) %>%
ggplot(aes(date, flow, color=site)) + geom_line()
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
) %>%
select(-lagrange) %>%
gather(site, flow, mod:lag_l) %>%
ggplot(aes(date, flow, color=site)) + geom_line()
ggplotly(p)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
) %>%
ggplotly(p)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
ggplot(aes(lag(lagrange), mod)) + geom_line()
p %>%
ggplot(aes(lag(lagrange), mod)) + geom_point()
library(purrr)
lagr <- readNWISdv("11289650", "00060", "2010-06-15")
tuo <- readNWISdv("11290000", "00060", "2010-06-15")
library(lubridate)
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9)
d
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>%
ggplot(aes(lag(lagrange), mod)) + geom_point()
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9,
!(year(date) %in% c(2017)))
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
ggplot(aes(lag(lagrange), mod)) + geom_point()
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9,
!(year(date) %in% c(2017)),
flow < 500)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
ggplot(aes(lag(lagrange), mod)) + geom_point()
p %>% filter(mod == 200)
p %>% filter(mod > 250)
p %>% filter(mod > 250, mod < 300)
p
p %>% filter(mod >250, mod < 300)
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9,
flow < 500)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>% filter(mod >250, mod < 300)
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
ggplot(aes(lag(lagrange), mod)) + geom_point()
lagr <- readNWISdv("11289650", "00060", "2000-06-15")
tuo <- readNWISdv("11290000", "00060", "2000-06-15")
ll <- c("11289650" = "lagrange", "11290000" = "mod")
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9,
flow < 500)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>% filter(mod >250, mod < 300)
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
ggplot(aes(lag(lagrange), mod)) + geom_point()
library(tidyr)
library(ggplot2)
library(dataRetrieval)
library(dplyr)
library(purrr)
library()
lagr <- readNWISdv("11289650", "00060", "2010-06-15")
tuo <- readNWISdv("11290000", "00060", "2010-06-15")
ll <- c("11289650" = "lagrange", "11290000" = "mod")
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9,
flow < 500)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>% filter(mod >250, mod < 300)
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
ggplot(aes(lag(lagrange), mod)) + geom_point()
p
ggplotly(p)
lag.plot(p$lagrange, )
library(tidyr)
library(ggplot2)
library(dataRetrieval)
library(dplyr)
library(purrr)
library()
lagr <- readNWISdv("11289650", "00060", "2010-06-15")
tuo <- readNWISdv("11290000", "00060", "2010-06-15")
ll <- c("11289650" = "lagrange", "11290000" = "mod")
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9,
flow < 500)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>% filter(mod >250, mod < 300)
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
ggplot(aes(lag(lagrange), mod)) + geom_point()
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
filter(lagrange < 200)
p %>%
filter(lagrange < 200, mod > 250)
p %>%
filter(lagrange < 200, mod > 250) %>%
nrow()
p %>%
filter(lagrange < 200) %>%
nrow()
3/304
304/3
3/304
3/304 * 100
1 - (3/304 * 100)
1 - (3/304)
d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p <-
x <-   d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
x %>%
select(-lag_l) %>%
ggplot(aes(flow, color=site)) + geom_density()
x %>%
select(-lag_l)
d %>%
ggplot(aes(flow, color=site)) + geom_density()
d %>%
ggplot(aes(flow, fill=site)) + geom_density()
d %>%
ggplot(aes(flow, fill=site)) + geom_density(alpha=0.3)
d %>%
ggplot(aes(flow, fill=site)) + geom_density(alpha=0.3)
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
filter(lagrange < 250, mod > 250) %>%
nrow()
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>% filter(mod >250, mod < 300)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>%
ggplot(aes(lagrange, mod)) + geom_point()
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
labs(x="Lagrange (cfs)"
y="Modesto (cfs)")
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9,
flow < 600)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>% filter(mod >250, mod < 300)
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9,
flow < 400)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>% filter(mod >250, mod < 300)
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
d <- dplyr::bind_rows(lagr, tuo) %>%
transmute(date = Date, site = ll[site_no], flow = X_00060_00003) %>%
filter(month(date) %in% 8:9,
flow < 550)
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p %>% filter(mod >250, mod < 300)
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
source('~/Documents/lagrange.R', echo=TRUE)
d
d
p <- d %>%
spread(site, flow) %>%
mutate(
lag_l = lag(lagrange)
)
p
p
ggplot(aes(lagrange, mod)) + geom_point() +
geom_hline(yintercept = 200) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
ggplot(aes(lagrange, mod)) + geom_point() +
geom_hline(aes(yintercept = 200)) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p %>% p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
geom_hline(yintercept = 200) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
geom_hline(yintercept = 200) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
geom_hline(yintercept = 250, color="red", linetype="d") +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
geom_hline(yintercept = 250, color="red", linetype=6) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
geom_hline(yintercept = 250, color="red", linetype=3) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
geom_hline(yintercept = 250, color="red", linetype=4) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p %>%
ggplot(aes(lagrange, mod)) + geom_point() +
geom_hline(yintercept = 250, color="red", linetype=5) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p %>% filter(mod >250, mod < 300)
p %>% filter(mod >250, mod < 300)  %>% knitr::kable()
p %>% filter(mod >250, mod < 300) %>%
select(-lag_l)%>% knitr::kable()
p %>%
ggplot(aes(lagrange, mod)) + geom_point(alpha=0.4) +
geom_hline(yintercept = 250, color="red", linetype=5) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p %>%
ggplot(aes(lagrange, mod)) + geom_point(alpha=0.5) +
geom_hline(yintercept = 250, color="red", linetype=5) +
labs(x="Lagrange (cfs)",
y="Modesto (cfs)")
p
p %>%
ggplot(aes(mod)) + geom_density()
p %>%
ggplot(aes(lagrange)) + geom_density()
p %>%
mutate(flag = mod > 250) %>%
ggplot(aes(lagrange, fill=flag)) + geom_density()
shiny::runApp()
runApp()
runApp()
runApp()
shiny::runApp()
diversion_data
diversion_data %>% filter(year(date) == 2017)
library(lubridate)
diversion_data %>% filter(year(date) == 2017)
diversion_data %>% filter(year(draft_date) == 2017)
diversion_data %>% arrange(draft_date) %>% tail()
runApp()
runApp()
flow_data
flow_data %>%
filter(location == "pmn")
library(shiny)
library(plotly)
library(dplyr)
library(lubridate)
library(DT)
library(leaflet)
library(rgdal)
library(zoo)
library(stringr)
library(readr)
library(tidyr)
library(forcats)
library(readr)
library(sparkline)
library(shinyjs)
library(measurements)
library(purrr)
library(shinytoastr)
flow_data %>%
filter(location == "pmn")
flow_data
flow_data %>%
filter(locatio-d == "pmn")
flow_data %>%
filter(location_id == "pmn")
flow_data %>%
filter(location_id == "pmn", year(datetime) == 2018) %>%
print()
flow_data %>%
filter(location_id == "pmn", year(datetime) == 2018) %>%
ggplot(aes(datetime, parameter_value))
flow_data %>%
filter(location_id == "pmn", year(datetime) == 2018) %>%
ggplot(aes(datetime, parameter_value)) + geom_line()
flow_data %>%
filter(location_id == "pmn", year(datetime) == 2018) %>%
group_by(date = as_date(datetime)) %>%
summarise(
daily_average = mean(parameter_value),
daily_max = max(parameter_value),
daily_min = min(parameter_value)
)
flow_data %>%
filter(location_id == "pmn", year(datetime) == 2018) %>%
group_by(date = as_date(datetime)) %>%
summarise(
daily_average = mean(parameter_value),
daily_max = max(parameter_value),
daily_min = min(parameter_value)
) %>%
ggplot(aes(datetime, daily_average)) + geom_line()
flow_data %>%
filter(location_id == "pmn", year(datetime) == 2018) %>%
group_by(date = as_date(datetime)) %>%
summarise(
daily_average = mean(parameter_value),
daily_max = max(parameter_value),
daily_min = min(parameter_value)
) %>%
ggplot(aes(datetime, daily_average)) + geom_line()
flow_data %>%
filter(location_id == "pmn", year(datetime) == 2018) %>%
group_by(date = as_date(datetime)) %>%
summarise(
daily_average = mean(parameter_value),
daily_max = max(parameter_value),
daily_min = min(parameter_value)
) %>%
ggplot(aes(date, daily_average)) + geom_line()
flow_data %>%
filter(location_id == "pmn", year(datetime) == 2018) %>%
group_by(date = as_date(datetime)) %>%
summarise(
daily_average = mean(parameter_value),
daily_median = median(parameter_value),
daily_max = max(parameter_value),
daily_min = min(parameter_value)
) %>%
ggplot(aes(date, daily_median)) + geom_line()
library(CDECRetrieve)
cdec_datasets("psh")
flow_data %>%
filter(location_id == "pmn", year(datetime) == 2018) %>%
group_by(date = as_date(datetime)) %>%
summarise(
daily_average = mean(parameter_value),
daily_median = median(parameter_value),
daily_max = max(parameter_value),
daily_min = min(parameter_value)
) %>%
ggplot(aes(date, daily_max)) + geom_line()
shiny::runApp()
View(historic_water_year_types)
shiny::runApp()
runApp()
install.packages("shinyWidgets")
install.packages("shinyWidgets")
shiny::runApp()
runApp()
runApp()
runApp()
library(shiny)
library(plotly)
library(dplyr)
library(lubridate)
library(DT)
library(leaflet)
library(rgdal)
library(zoo)
library(stringr)
library(readr)
library(tidyr)
library(forcats)
library(readr)
library(sparkline)
library(shinyjs)
library(measurements)
library(purrr)
library(shinytoastr)
library(shinyWidgets)
